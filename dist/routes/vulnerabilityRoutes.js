"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const express_1 = require("express");
const vulnerabilityController_1 = require("../controllers/vulnerabilityController");
const authenticate_1 = require("../middleware/authenticate");
const authorize_1 = require("../middleware/authorize");
const auth_1 = require("../types/auth");
const express_validator_1 = require("express-validator");
const validate_1 = require("../middleware/validate");
const router = (0, express_1.Router)();
router.use(authenticate_1.authenticate);
router.get('/config', (0, authorize_1.requirePermission)(auth_1.Permission.SYSTEM_SETTINGS), vulnerabilityController_1.VulnerabilityController.getConfig);
router.get('/config/history', (0, authorize_1.requirePermission)(auth_1.Permission.SYSTEM_SETTINGS), vulnerabilityController_1.VulnerabilityController.getHistory);
router.post('/preview', (0, authorize_1.requirePermission)(auth_1.Permission.SYSTEM_SETTINGS), [
    (0, express_validator_1.body)('weights').notEmpty().withMessage('Weights are required'),
    (0, express_validator_1.body)('bands').notEmpty().withMessage('Bands are required'),
    validate_1.validate
], vulnerabilityController_1.VulnerabilityController.preview);
router.post('/config', (0, authorize_1.requirePermission)(auth_1.Permission.SYSTEM_SETTINGS), [
    (0, express_validator_1.body)('weights').notEmpty().withMessage('Weights are required'),
    (0, express_validator_1.body)('bands').notEmpty().withMessage('Bands are required'),
    validate_1.validate
], vulnerabilityController_1.VulnerabilityController.save);
exports.default = router;
//# sourceMappingURL=vulnerabilityRoutes.js.map